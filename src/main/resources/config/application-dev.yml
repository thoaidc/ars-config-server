# ===================================================================
# Spring Boot configuration.
#
# This configuration will be overridden by the Spring profile you use
# For example: application-dev.yml if you use the "dev" profile.
# ===================================================================

# ===================================================================
# Standard Spring Boot properties.
# Full reference is available at:
# https://docs.spring.io/spring-boot/reference/features/profiles.html
# ===================================================================

logging:
  level:
    root: debug
    org.springframework.cloud.config: debug
    org.springframework.vault: debug
    org.eclipse.jgit.util: info
    org.eclipse.jgit.transport: info
    org.eclipse.jgit.internal.storage.file: info
  charset:
    console: UTF-8
    file: UTF-8
  file:
    path: opt/logs/config-server

spring:
  cloud:
    # Declare how to connect to the HashiCorp Vault Server external
    vault:
      uri: http://localhost:8200
      authentication: TOKEN
      token: token
      kv:
        # You will manage the key-value at /secret in the Vault UI
        backend: secret
        # Used to combine context + profile into Vault path to query secret.
        # For example if: application name = config-client, profile = dev, profile-separator = '-'
        # Then Spring will look for secret at the following paths (in order of priority):
        # /secret/config-client-dev
        # /secret/config-client
        # /secret/application-dev
        # /secret/application
        profile-separator: '-'
        # This is the default context name if spring.application.name is not provided
        # For example, if the client app does not send a specific application name
        # Vault will attempt to retrieve the configuration from folder: /secret/application/
        default-context: application
    config:
      server:
        # Specifies which configuration to retrieve from Vault to return to the client
        # Only works if spring.cloud.vault config above has successfully connected
        vault:
          kv-version: 2 # Using key-value engines version 2
          token: token
          backend: secret
          default-key: application
          profile-separator: "-"
          order: -10
        native:
          search-locations:
            - file:./configs
            - file:./configs/{application}
